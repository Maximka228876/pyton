from aiogram import Router, F
from aiogram.types import Message, CallbackQuery
from keyboards.main import get_diseases_menu, get_back_to_diseases_keyboard
import logging
import time

router = Router()
logger = logging.getLogger(__name__)

DISEASES_INFO = {
    "myopia": {
        "title": "üîç –ë–ª–∏–∑–æ—Ä—É–∫–æ—Å—Ç—å (–ú–∏–æ–ø–∏—è)",
        "content": (
            "<b>–ß—Ç–æ —ç—Ç–æ?</b>\n"
            "–ù–∞—Ä—É—à–µ–Ω–∏–µ —Ä–µ—Ñ—Ä–∞–∫—Ü–∏–∏, –ø—Ä–∏ –∫–æ—Ç–æ—Ä–æ–º —É–¥–∞–ª–µ–Ω–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã –≤–∏–¥–Ω—ã —Ä–∞–∑–º—ã—Ç–æ.\n\n"
            
            "<b>–û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:</b>\n"
            "‚ñ´Ô∏è –£–¥–ª–∏–Ω–µ–Ω–Ω–∞—è —Ñ–æ—Ä–º–∞ –≥–ª–∞–∑–Ω–æ–≥–æ —è–±–ª–æ–∫–∞\n"
            "‚ñ´Ô∏è –ì–µ–Ω–µ—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–µ–¥—Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç—å\n"
            "‚ñ´Ô∏è –ß—Ä–µ–∑–º–µ—Ä–Ω—ã–µ –∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞–≥—Ä—É–∑–∫–∏\n\n"
            
            "<b>–°–∏–º–ø—Ç–æ–º—ã:</b>\n"
            "‚Ä¢ –†–∞–∑–º—ã—Ç–æ–µ –∑—Ä–µ–Ω–∏–µ –≤–¥–∞–ª–∏\n"
            "‚Ä¢ –ü—Ä–∏—â—É—Ä–∏–≤–∞–Ω–∏–µ\n"
            "‚Ä¢ –ì–æ–ª–æ–≤–Ω—ã–µ –±–æ–ª–∏ –ø—Ä–∏ –≤–æ–∂–¥–µ–Ω–∏–∏/–ø—Ä–æ—Å–º–æ—Ç—Ä–µ –¢–í\n\n"
            
            "<b>–ö–æ—Ä—Ä–µ–∫—Ü–∏—è:</b>\n"
            "‚úÖ –û—á–∫–∏ —Å —Ä–∞—Å—Å–µ–∏–≤–∞—é—â–∏–º–∏ –ª–∏–Ω–∑–∞–º–∏\n"
            "‚úÖ –ö–æ–Ω—Ç–∞–∫—Ç–Ω—ã–µ –ª–∏–Ω–∑—ã (–º—è–≥–∫–∏–µ, –Ω–æ—á–Ω—ã–µ –æ—Ä—Ç–æ–∫–µ—Ä–∞—Ç–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–µ)\n"
            "‚úÖ –õ–∞–∑–µ—Ä–Ω–∞—è –∫–æ—Ä—Ä–µ–∫—Ü–∏—è (–ø—Ä–∏ —Å—Ç–∞–±–∏–ª—å–Ω–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏)\n\n"
            
            "<b>–ü—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫–∞:</b>\n"
            "‚Ä¢ –ì–∏–º–Ω–∞—Å—Ç–∏–∫–∞ –¥–ª—è –≥–ª–∞–∑ –∫–∞–∂–¥—ã–µ 30 –º–∏–Ω—É—Ç —Ä–∞–±–æ—Ç—ã\n"
            "‚Ä¢ –û—Å–≤–µ—â–µ–Ω–∏–µ –Ω–µ –º–µ–Ω–µ–µ 500 –ª—é–∫—Å"
        )
    },
    "hyperopia": {
        "title": "üåÄ –î–∞–ª—å–Ω–æ–∑–æ—Ä–∫–æ—Å—Ç—å (–ì–∏–ø–µ—Ä–º–µ—Ç—Ä–æ–ø–∏—è)",
        "content": (
            "<b>–ß—Ç–æ —ç—Ç–æ?</b>\n"
            "–§–æ–∫—É—Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∑–∞ —Å–µ—Ç—á–∞—Ç–∫–æ–π, —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ —Å —Ñ–æ–∫—É—Å–∏—Ä–æ–≤–∫–æ–π –Ω–∞ –±–ª–∏–∑–∫–∏—Ö –æ–±—ä–µ–∫—Ç–∞—Ö.\n\n"
            
            "<b>–ü—Ä–∏—á–∏–Ω—ã:</b>\n"
            "‚ñ´Ô∏è –£–∫–æ—Ä–æ—á–µ–Ω–Ω–æ–µ –≥–ª–∞–∑–Ω–æ–µ —è–±–ª–æ–∫–æ\n"
            "‚ñ´Ô∏è –í–æ–∑—Ä–∞—Å—Ç–Ω–∞—è –ø—Ä–µ—Å–±–∏–æ–ø–∏—è (–ø–æ—Å–ª–µ 40 –ª–µ—Ç)\n"
            "‚ñ´Ô∏è –°–ª–∞–±–æ—Å—Ç—å —Ü–∏–ª–∏–∞—Ä–Ω–æ–π –º—ã—à—Ü—ã\n\n"
            
            "<b>–°–∏–º–ø—Ç–æ–º—ã:</b>\n"
            "‚Ä¢ –£—Å—Ç–∞–ª–æ—Å—Ç—å –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏\n"
            "‚Ä¢ –ñ–∂–µ–Ω–∏–µ –≤ –≥–ª–∞–∑–∞—Ö\n"
            "‚Ä¢ –ß–∞—Å—Ç—ã–µ –∫–æ–Ω—ä—é–Ω–∫—Ç–∏–≤–∏—Ç—ã\n\n"
            
            "<b>–†–µ—à–µ–Ω–∏–µ:</b>\n"
            "‚úÖ –ü–ª—é—Å–æ–≤—ã–µ –æ—á–∫–∏/–ª–∏–Ω–∑—ã\n"
            "‚úÖ –õ–∞–∑–µ—Ä–Ω–∞—è —Ç–µ—Ä–º–æ–∫–µ—Ä–∞—Ç–æ–ø–ª–∞—Å—Ç–∏–∫–∞ (LTK)\n\n"
            
            "<b>–í–∞–∂–Ω–æ:</b>\n"
            "–î–µ—Ç—è–º –¥–æ 7 –ª–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ü–∏—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞ –¥–ª—è –ø—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫–∏ –∫–æ—Å–æ–≥–ª–∞–∑–∏—è!"
        )
    },
    "cataract": {
        "title": "‚ö™Ô∏è –ö–∞—Ç–∞—Ä–∞–∫—Ç–∞",
        "content": (
            "<b>–ß—Ç–æ —ç—Ç–æ?</b>\n"
            "–ü–æ–º—É—Ç–Ω–µ–Ω–∏–µ —Ö—Ä—É—Å—Ç–∞–ª–∏–∫–∞, –≤–µ–¥—É—â–µ–µ –∫ —Å–Ω–∏–∂–µ–Ω–∏—é –∑—Ä–µ–Ω–∏—è.\n\n"
            
            "<b>–ü—Ä–∏—á–∏–Ω—ã:</b>\n"
            "‚ñ´Ô∏è –í–æ–∑—Ä–∞—Å—Ç (90% —Å–ª—É—á–∞–µ–≤ –ø–æ—Å–ª–µ 60 –ª–µ—Ç)\n"
            "‚ñ´Ô∏è –¢—Ä–∞–≤–º—ã, –£–§-–∏–∑–ª—É—á–µ–Ω–∏–µ\n"
            "‚ñ´Ô∏è –°–∞—Ö–∞—Ä–Ω—ã–π –¥–∏–∞–±–µ—Ç\n\n"
            
            "<b>–°–∏–º–ø—Ç–æ–º—ã:</b>\n"
            "‚Ä¢ –¢—É–º–∞–Ω –ø–µ—Ä–µ–¥ –≥–ª–∞–∑–∞–º–∏\n"
            "‚Ä¢ –ë–ª–∏–∫–∏ –æ—Ç —Ñ–∞—Ä/—Ñ–æ–Ω–∞—Ä–µ–π\n"
            "‚Ä¢ –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ü–≤–µ—Ç–æ–≤–æ—Å–ø—Ä–∏—è—Ç–∏—è\n\n"
            
            "<b>–õ–µ—á–µ–Ω–∏–µ:</b>\n"
            "‚úÖ –§–∞–∫–æ—ç–º—É–ª—å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —Å –ò–û–õ-–∏–º–ø–ª–∞–Ω—Ç–∞—Ü–∏–µ–π\n"
            "‚úÖ –õ–∞–∑–µ—Ä–Ω–∞—è —Ö–∏—Ä—É—Ä–≥–∏—è (Femto)\n\n"
            
            "<b>–ü—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫–∞:</b>\n"
            "‚Ä¢ –°–æ–ª–Ω—Ü–µ–∑–∞—â–∏—Ç–Ω—ã–µ –æ—á–∫–∏ —Å UV-—Ñ–∏–ª—å—Ç—Ä–æ–º\n"
            "‚Ä¢ –ö–æ–Ω—Ç—Ä–æ–ª—å —É—Ä–æ–≤–Ω—è –≥–ª—é–∫–æ–∑—ã"
        )
    },
    "glaucoma": {
        "title": "üü¢ –ì–ª–∞—É–∫–æ–º–∞",
        "content": (
            "<b>–ß—Ç–æ —ç—Ç–æ?</b>\n"
            "–ü–æ–≤—Ä–µ–∂–¥–µ–Ω–∏–µ –∑—Ä–∏—Ç–µ–ª—å–Ω–æ–≥–æ –Ω–µ—Ä–≤–∞ –∏–∑-–∑–∞ –ø–æ–≤—ã—à–µ–Ω–Ω–æ–≥–æ –≤–Ω—É—Ç—Ä–∏–≥–ª–∞–∑–Ω–æ–≥–æ –¥–∞–≤–ª–µ–Ω–∏—è.\n\n"
            
            "<b>–ü—Ä–∏—á–∏–Ω—ã:</b>\n"
            "‚ñ´Ô∏è –ù–∞—Ä—É—à–µ–Ω–∏–µ –æ—Ç—Ç–æ–∫–∞ –≤–æ–¥—è–Ω–∏—Å—Ç–æ–π –≤–ª–∞–≥–∏\n"
            "‚ñ´Ô∏è –ù–∞—Å–ª–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å\n"
            "‚ñ´Ô∏è –ú–∏–≥—Ä–µ–Ω–∏, –≥–∏–ø–µ—Ä—Ç–æ–Ω–∏—è\n\n"
            
            "<b>–°–∏–º–ø—Ç–æ–º—ã:</b>\n"
            "‚Ä¢ –°–ª–µ–ø—ã–µ –ø—è—Ç–Ω–∞ –≤ –ø–µ—Ä–∏—Ñ–µ—Ä–∏–∏\n"
            "‚Ä¢ –†–∞–¥—É–∂–Ω—ã–µ –∫—Ä—É–≥–∏ –≤–æ–∫—Ä—É–≥ —Å–≤–µ—Ç–∞\n"
            "‚Ä¢ –†–µ–∑–∫–∞—è –±–æ–ª—å –ø—Ä–∏ –æ—Å—Ç—Ä–æ–º –ø—Ä–∏—Å—Ç—É–ø–µ\n\n"
            
            "<b>–¢–µ—Ä–∞–ø–∏—è:</b>\n"
            "‚úÖ –ö–∞–ø–ª–∏ (–¢–∏–º–æ–ª–æ–ª, –ü–∏–ª–æ–∫–∞—Ä–ø–∏–Ω)\n"
            "‚úÖ –õ–∞–∑–µ—Ä–Ω–∞—è –∏—Ä–∏–¥–æ—Ç–æ–º–∏—è\n"
            "‚úÖ –®—É–Ω—Ç–∏—Ä—É—é—â–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏\n\n"
            
            "<b>–§–∞–∫—Ç:</b>\n"
            "–ù–µ–æ–±—Ä–∞—Ç–∏–º–∞, –Ω–æ —Ä–∞–Ω–Ω—è—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –∑—Ä–µ–Ω–∏–µ!"
        )
    },
    "conjunctivitis": {
        "title": "üëÅÔ∏è –ö–æ–Ω—ä—é–Ω–∫—Ç–∏–≤–∏—Ç",
        "content": (
            "<b>–ß—Ç–æ —ç—Ç–æ?</b>\n"
            "–í–æ—Å–ø–∞–ª–µ–Ω–∏–µ —Å–ª–∏–∑–∏—Å—Ç–æ–π –æ–±–æ–ª–æ—á–∫–∏ –≥–ª–∞–∑–∞.\n\n"
            
            "<b>–ü—Ä–∏—á–∏–Ω—ã:</b>\n"
            "‚ñ´Ô∏è –ë–∞–∫—Ç–µ—Ä–∏–∏ (Staphylococcus, Streptococcus)\n"
            "‚ñ´Ô∏è –í–∏—Ä—É—Å—ã (–∞–¥–µ–Ω–æ–≤–∏—Ä—É—Å, –≥–µ—Ä–ø–µ—Å)\n"
            "‚ñ´Ô∏è –ê–ª–ª–µ—Ä–≥–µ–Ω—ã (–ø—ã–ª—å—Ü–∞, –∫–æ—Å–º–µ—Ç–∏–∫–∞)\n\n"
            
            "<b>–°–∏–º–ø—Ç–æ–º—ã:</b>\n"
            "‚Ä¢ –ü–æ–∫—Ä–∞—Å–Ω–µ–Ω–∏–µ, –∑—É–¥\n"
            "‚Ä¢ –ì–Ω–æ–π–Ω—ã–µ –≤—ã–¥–µ–ª–µ–Ω–∏—è (–±–∞–∫—Ç–µ—Ä–∏–∞–ª—å–Ω–∞—è —Ñ–æ—Ä–º–∞)\n"
            "‚Ä¢ –°–ª–µ–∑–æ—Ç–µ—á–µ–Ω–∏–µ (–≤–∏—Ä—É—Å–Ω–∞—è/–∞–ª–ª–µ—Ä–≥–∏—á–µ—Å–∫–∞—è)\n\n"
            
            "<b>–õ–µ—á–µ–Ω–∏–µ:</b>\n"
            "‚úÖ –ê–Ω—Ç–∏–±–∏–æ—Ç–∏–∫–∏ (–¶–∏–ø—Ä–æ—Ñ–ª–æ–∫—Å–∞—Ü–∏–Ω)\n"
            "‚úÖ –ü—Ä–æ—Ç–∏–≤–æ–≤–∏—Ä—É—Å–Ω—ã–µ (–ê—Ü–∏–∫–ª–æ–≤–∏—Ä)\n"
            "‚úÖ –ê–Ω—Ç–∏–≥–∏—Å—Ç–∞–º–∏–Ω–Ω—ã–µ (–ö–µ—Ç–æ—Ç–∏—Ñ–µ–Ω)\n\n"
            
            "<b>–í–∞–∂–Ω–æ:</b>\n"
            "–ù–µ –Ω–æ—Å–∏—Ç–µ –∫–æ–Ω—Ç–∞–∫—Ç–Ω—ã–µ –ª–∏–Ω–∑—ã –≤–æ –≤—Ä–µ–º—è –±–æ–ª–µ–∑–Ω–∏!"
        )
    },
    "astigmatism": {
        "title": "üåÄ –ê—Å—Ç–∏–≥–º–∞—Ç–∏–∑–º",
        "content": (
            "<b>–ß—Ç–æ —ç—Ç–æ?</b>\n"
            "–ò—Å–∫–∞–∂–µ–Ω–∏–µ –∑—Ä–µ–Ω–∏—è –∏–∑-–∑–∞ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Ñ–æ—Ä–º—ã —Ä–æ–≥–æ–≤–∏—Ü—ã/—Ö—Ä—É—Å—Ç–∞–ª–∏–∫–∞.\n\n"
            
            "<b>–ü—Ä–∏—á–∏–Ω—ã:</b>\n"
            "‚ñ´Ô∏è –í—Ä–æ–∂–¥–µ–Ω–Ω–∞—è –∞–Ω–æ–º–∞–ª–∏—è (85% —Å–ª—É—á–∞–µ–≤)\n"
            "‚ñ´Ô∏è –¢—Ä–∞–≤–º—ã, –∫–µ—Ä–∞—Ç–æ–∫–æ–Ω—É—Å\n"
            "‚ñ´Ô∏è –†—É–±—Ü—ã –ø–æ—Å–ª–µ –æ–ø–µ—Ä–∞—Ü–∏–π\n\n"
            
            "<b>–°–∏–º–ø—Ç–æ–º—ã:</b>\n"
            "‚Ä¢ –ò—Å–∫–∞–∂–µ–Ω–∏–µ –ø—Ä—è–º—ã—Ö –ª–∏–Ω–∏–π\n"
            "‚Ä¢ –î–≤–æ–µ–Ω–∏–µ\n"
            "‚Ä¢ –ì–æ–ª–æ–≤–Ω–∞—è –±–æ–ª—å –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏\n\n"
            
            "<b>–ö–æ—Ä—Ä–µ–∫—Ü–∏—è:</b>\n"
            "‚úÖ –¢–æ—Ä–∏—á–µ—Å–∫–∏–µ –ª–∏–Ω–∑—ã\n"
            "‚úÖ –ì–∞–∑–æ–ø—Ä–æ–Ω–∏—Ü–∞–µ–º—ã–µ –ª–∏–Ω–∑—ã (–Ω–æ—á–Ω—ã–µ)\n"
            "‚úÖ –§–µ–º—Ç–æ–õ–ê–°–ò–ö\n\n"
            
            "<b>–ò–Ω—Ç–µ—Ä–µ—Å–Ω–æ:</b>\n"
            "–ï—Å—Ç—å —É 60% –ª—é–¥–µ–π, –Ω–æ –ª–∏—à—å 15% –Ω—É–∂–¥–∞—é—Ç—Å—è –≤ –∫–æ—Ä—Ä–µ–∫—Ü–∏–∏."
        )
    },
    "colorblindness": {
        "title": "üé® –î–∞–ª—å—Ç–æ–Ω–∏–∑–º",
        "content": (
            "<b>–ß—Ç–æ —ç—Ç–æ?</b>\n"
            "–ù–∞—Ä—É—à–µ–Ω–∏–µ –≤–æ—Å–ø—Ä–∏—è—Ç–∏—è —Ü–≤–µ—Ç–æ–≤ (—á–∞—â–µ –Ω–∞—Å–ª–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ–µ).\n\n"
            
            "<b>–ü—Ä–∏—á–∏–Ω—ã:</b>\n"
            "‚ñ´Ô∏è –î–µ—Ñ–µ–∫—Ç X-—Ö—Ä–æ–º–æ—Å–æ–º—ã (—É –º—É–∂—á–∏–Ω 8%, —É –∂–µ–Ω—â–∏–Ω 0.4%)\n"
            "‚ñ´Ô∏è –ü–æ–≤—Ä–µ–∂–¥–µ–Ω–∏–µ —Å–µ—Ç—á–∞—Ç–∫–∏/–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–≥–æ –Ω–µ—Ä–≤–∞\n\n"
            
            "<b>–°–∏–º–ø—Ç–æ–º—ã:</b>\n"
            "‚Ä¢ –ü—É—Ç–∞–Ω–∏—Ü–∞ –≤ —Ü–≤–µ—Ç–∞—Ö (–∫—Ä–∞—Å–Ω—ã–π-–∑–µ–ª–µ–Ω—ã–π)\n"
            "‚Ä¢ –°–µ—Ä—ã–µ –æ—Ç—Ç–µ–Ω–∫–∏ –≤ —Å–∏–Ω–µ-–∂–µ–ª—Ç–æ–º —Å–ø–µ–∫—Ç—Ä–µ (—Ç—Ä–∏—Ç–∞–Ω–æ–ø–∏—è)\n\n"
            
            "<b>–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:</b>\n"
            "‚úÖ –¢–∞–±–ª–∏—Ü—ã –ò—à–∏—Ö–∞—Ä—ã\n"
            "‚úÖ –ê–Ω–æ–º–∞–ª–æ—Å–∫–æ–ø–∏—è\n\n"
            
            "<b>–ñ–∏–∑–Ω—å —Å –¥–∞–ª—å—Ç–æ–Ω–∏–∑–º–æ–º:</b>\n"
            "–°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (Colorino), –º–∞—Ä–∫–∏—Ä–æ–≤–∫–∞ –æ–¥–µ–∂–¥—ã."
        )
    }
}

@router.message(F.text == "ü§í –ó–∞–±–æ–ª–µ–≤–∞–Ω–∏—è")
async def diseases_menu(message: Message):
    logger.info("–ö–Ω–æ–ø–∫–∞ '–ó–∞–±–æ–ª–µ–≤–∞–Ω–∏—è' –Ω–∞–∂–∞—Ç–∞!")
    await message.answer(
        "üìö –í—ã–±–µ—Ä–∏—Ç–µ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–µ:", 
        reply_markup=get_diseases_menu()
    )

@router.callback_query(F.data.startswith("disease_"))
async def show_disease_info(callback: CallbackQuery):
    disease_key = callback.data.split("_")[1]
    disease = DISEASES_INFO.get(disease_key)
    
    text = f"<b>{disease['title']}</b>\n\n{disease['content']}"
    await callback.message.edit_text(
        text,
        parse_mode="HTML",
        reply_markup=get_back_to_diseases_keyboard()
    )
    await callback.answer()

@router.callback_query(F.data == "back_diseases")
async def back_to_diseases_menu(callback: CallbackQuery):
    # –î–æ–±–∞–≤–ª—è–µ–º –≤—Ä–µ–º–µ–Ω–Ω—É—é –º–µ—Ç–∫—É –≤ —Ç–µ–∫—Å—Ç, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –æ—à–∏–±–∫–∏ "message not modified"
    await callback.message.edit_text(
        f"üìö –í—ã–±–µ—Ä–∏—Ç–µ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–µ:\n<!-- {time.time()} -->",
        reply_markup=get_diseases_menu()
    )
    await callback.answer()
